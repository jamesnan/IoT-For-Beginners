
# å°†ä½ çš„æ¤ç‰©è¿ç§»åˆ°äº‘ç«¯

![æœ¬è¯¾çš„ sketchnote æ¦‚è¿°](../../../../sketchnotes/lesson-8.jpg)

> [Nitya Narasimhan](https://github.com/nitya) çš„è‰å›¾ç¬”è®°ã€‚å•å‡»å›¾åƒå¯æŸ¥çœ‹æ›´å¤§çš„ç‰ˆæœ¬ã€‚

æœ¬è¯¾ç¨‹æ˜¯ [Microsoft Reactor](https://developer.microsoft.com/reactor/?WT.mc_id=academic-17441-jabenn)) çš„ [IoT åˆå­¦è€…é¡¹ç›® 2 - æ•°å­—å†œä¸šç³»åˆ—](https://youtube.com/playlist?list=PLmsFUfdnGr3yCutmcVg6eAUEfsGiFXgcx) çš„ä¸€éƒ¨åˆ†ã€‚

[![ä½¿ç”¨ Azure IoT ä¸­å¿ƒå°†æ‚¨çš„è®¾å¤‡è¿æ¥åˆ°äº‘](https://img.youtube.com/vi/bNxjopXkhvk/0.jpg)](https://youtu.be/bNxjopXkhvk)

## è¯¾å‰æµ‹éªŒ

[è¯¾å‰æµ‹éªŒ](https://black-meadow-040d15503.1.azurestaticapps.net/quiz/15)

ï¼ƒï¼ƒ ä»‹ç»

åœ¨ä¸Šä¸€è¯¾ä¸­ï¼Œæ‚¨å­¦ä¹ äº†å¦‚ä½•å°†å·¥å‚è¿æ¥åˆ° MQTT ä»£ç†å¹¶é€šè¿‡æœ¬åœ°è¿è¡Œçš„æŸäº›æœåŠ¡å™¨ä»£ç æ§åˆ¶ä¸­ç»§ã€‚è¿™æ„æˆäº†è¿æ¥äº’è”ç½‘çš„è‡ªåŠ¨æµ‡æ°´ç³»ç»Ÿçš„æ ¸å¿ƒï¼Œä»å®¶åº­çš„ä¸ªä½“æ¤ç‰©åˆ°å•†ä¸šå†œåœºéƒ½å¯ä»¥ä½¿ç”¨è¯¥ç³»ç»Ÿã€‚

IoT è®¾å¤‡ä¸å…¬å…± MQTT ä»£ç†è¿›è¡Œé€šä¿¡ä½œä¸ºæ¼”ç¤ºåŸç†çš„ä¸€ç§æ–¹å¼ï¼Œä½†è¿™å¹¶ä¸æ˜¯æœ€å¯é æˆ–æœ€å®‰å…¨çš„æ–¹å¼ã€‚åœ¨æœ¬è¯¾ç¨‹ä¸­ï¼Œæ‚¨å°†äº†è§£äº‘ä»¥åŠå…¬å…±äº‘æœåŠ¡æä¾›çš„ç‰©è”ç½‘åŠŸèƒ½ã€‚æ‚¨è¿˜å°†äº†è§£å¦‚ä½•å°†æ‚¨çš„å·¥å‚ä»å…¬å…± MQTT ä»£ç†è¿ç§»åˆ°è¿™äº›äº‘æœåŠ¡ä¹‹ä¸€ã€‚

åœ¨æœ¬è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»ï¼š

* [ä»€ä¹ˆæ˜¯äº‘ï¼Ÿ](#what-is-the-cloud)
* [åˆ›å»ºäº‘è®¢é˜…](#create-a-cloud-subscription)
* [äº‘ç‰©è”ç½‘æœåŠ¡](#cloud-iot-services)
* [åœ¨äº‘ç«¯åˆ›å»º IoT æœåŠ¡](#create-an-iot-service-in-the-cloud)
* [ä¸ IoT ä¸­å¿ƒé€šä¿¡](#communicate-with-iot-hub)
* [å°†æ‚¨çš„è®¾å¤‡è¿æ¥åˆ° IoT æœåŠ¡](#connect-your-device-to-the-iot-service)

## ä»€ä¹ˆæ˜¯äº‘ï¼Ÿ

åœ¨äº‘å‡ºç°ä¹‹å‰ï¼Œå½“ä¸€å®¶å…¬å¸æƒ³è¦å‘å…¶å‘˜å·¥ï¼ˆä¾‹å¦‚æ•°æ®åº“æˆ–æ–‡ä»¶å­˜å‚¨ï¼‰æˆ–å…¬ä¼—ï¼ˆä¾‹å¦‚ç½‘ç«™ï¼‰æä¾›æœåŠ¡æ—¶ï¼Œä»–ä»¬ä¼šæ„å»ºå¹¶è¿è¡Œæ•°æ®ä¸­å¿ƒã€‚å…¶èŒƒå›´ä»å…·æœ‰å°‘é‡è®¡ç®—æœºçš„æˆ¿é—´åˆ°å…·æœ‰è®¸å¤šè®¡ç®—æœºçš„å»ºç­‘ç‰©ã€‚è¯¥å…¬å¸å°†ç®¡ç†ä¸€åˆ‡ï¼ŒåŒ…æ‹¬ï¼š

* è´­ä¹°ç”µè„‘
* ç¡¬ä»¶ç»´æŠ¤
* ç”µæºå’Œå†·å´
* è”ç½‘
* å®‰å…¨æ€§ï¼ŒåŒ…æ‹¬ä¿æŠ¤å»ºç­‘ç‰©å’Œè®¡ç®—æœºä¸Šè½¯ä»¶çš„å®‰å…¨
* è½¯ä»¶å®‰è£…å’Œæ›´æ–°

è¿™å¯èƒ½éå¸¸æ˜‚è´µï¼Œéœ€è¦å¤§é‡ç†Ÿç»ƒçš„å‘˜å·¥ï¼Œå¹¶ä¸”åœ¨éœ€è¦æ—¶æ”¹å˜éå¸¸ç¼“æ…¢ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€å®¶åœ¨çº¿å•†åº—éœ€è¦ä¸ºç¹å¿™çš„å‡æœŸåšå¥½è®¡åˆ’ï¼Œä»–ä»¬éœ€è¦æå‰å‡ ä¸ªæœˆè®¡åˆ’è´­ä¹°æ›´å¤šç¡¬ä»¶ï¼Œé…ç½®å®ƒï¼Œå®‰è£…å®ƒå¹¶å®‰è£…è½¯ä»¶æ¥è¿è¡Œä»–ä»¬çš„é”€å”®æµç¨‹ã€‚å‡æœŸç»“æŸåï¼Œé”€é‡å›è½ï¼Œä»–ä»¬èŠ±é’±è´­ä¹°çš„ç”µè„‘å°†é—²ç½®åˆ°ä¸‹ä¸€ä¸ªæ—ºå­£ã€‚

âœ… æ‚¨è®¤ä¸ºè¿™ä¼šè®©å…¬å¸è¿…é€Ÿé‡‡å–è¡ŒåŠ¨å—ï¼Ÿå¦‚æœä¸€å®¶åœ¨çº¿æœè£…é›¶å”®å•†å› ä¸ºåäººç©¿ç€è¡£æœè€Œçªç„¶èµ°çº¢ï¼Œä»–ä»¬æ˜¯å¦èƒ½å¤Ÿè¶³å¤Ÿå¿«åœ°æé«˜è®¡ç®—èƒ½åŠ›æ¥æ”¯æŒçªç„¶æ¶Œå…¥çš„è®¢å•ï¼Ÿ

### åˆ«äººçš„ç”µè„‘

äº‘ç»å¸¸è¢«æˆç§°ä¸º`åˆ«äººçš„è®¡ç®—æœº`  ã€‚æœ€åˆçš„æƒ³æ³•å¾ˆç®€å•â€”â€”æ‚¨ä¸ç”¨è´­ä¹°è®¡ç®—æœºï¼Œè€Œæ˜¯ç§Ÿç”¨åˆ«äººçš„è®¡ç®—æœºã€‚å…¶ä»–äººï¼ˆäº‘è®¡ç®—æä¾›å•†ï¼‰å°†ç®¡ç†å·¨å¤§çš„æ•°æ®ä¸­å¿ƒã€‚ä»–ä»¬å°†è´Ÿè´£è´­ä¹°å’Œå®‰è£…ç¡¬ä»¶ã€ç®¡ç†ç”µæºå’Œå†·å´ã€ç½‘ç»œã€å»ºç­‘å®‰å…¨ã€ç¡¬ä»¶å’Œè½¯ä»¶æ›´æ–°ç­‰ä¸€åˆ‡ã€‚ä½œä¸ºå®¢æˆ·ï¼Œæ‚¨å¯ä»¥ç§Ÿç”¨æ‰€éœ€çš„è®¡ç®—æœºï¼Œéšç€éœ€æ±‚æ¿€å¢è€Œç§Ÿç”¨æ›´å¤šè®¡ç®—æœºï¼Œç„¶ååœ¨éœ€æ±‚ä¸‹é™æ—¶å‡å°‘ç§Ÿç”¨æ•°é‡ã€‚è¿™äº›äº‘æ•°æ®ä¸­å¿ƒéå¸ƒä¸–ç•Œå„åœ°ã€‚

![Microsoft äº‘æ•°æ®ä¸­å¿ƒ](../../../../images/azure-region-existing.png)
![å¾®è½¯äº‘æ•°æ®ä¸­å¿ƒè®¡åˆ’æ‰©å»º](../../../../images/azure-region-planned-expansion.png)

è¿™äº›æ•°æ®ä¸­å¿ƒçš„è§„æ¨¡å¯èƒ½æœ‰æ•°å¹³æ–¹å…¬é‡Œã€‚ä¸Šé¢çš„å›¾ç‰‡æ˜¯å‡ å¹´å‰åœ¨ Microsoft äº‘æ•°æ®ä¸­å¿ƒæ‹æ‘„çš„ï¼Œæ˜¾ç¤ºäº†åˆå§‹å¤§å°ä»¥åŠè®¡åˆ’çš„æ‰©å±•ã€‚æ‰©å»ºæ¸…ç†é¢ç§¯è¶…è¿‡5å¹³æ–¹å…¬é‡Œã€‚

> ğŸ’ è¿™äº›æ•°æ®ä¸­å¿ƒéœ€è¦å¤§é‡ç”µåŠ›ï¼Œä»¥è‡³äºæœ‰äº›æ•°æ®ä¸­å¿ƒæ‹¥æœ‰è‡ªå·±çš„å‘ç”µç«™ã€‚ç”±äºå®ƒä»¬çš„è§„æ¨¡å’Œäº‘æä¾›å•†çš„æŠ•èµ„æ°´å¹³ï¼Œå®ƒä»¬é€šå¸¸éå¸¸ç¯ä¿ã€‚å®ƒä»¬æ¯”å¤§é‡çš„å°å‹æ•°æ®ä¸­å¿ƒæ›´æœ‰æ•ˆç‡ï¼Œå®ƒä»¬ä¸»è¦ä¾é å¯å†ç”Ÿèƒ½æºè¿è¡Œï¼Œäº‘æä¾›å•†åŠªåŠ›å‡å°‘æµªè´¹ï¼Œå‡å°‘ç”¨æ°´é‡ï¼Œå¹¶é‡æ–°ç§æ¤æ£®æ—ï¼Œä»¥å¼¥è¡¥ä¸ºå»ºè®¾æ•°æ®ä¸­å¿ƒæä¾›ç©ºé—´è€Œç ä¼çš„æ£®æ—ã€‚æ‚¨å¯ä»¥åœ¨ [Azure å¯æŒç»­å‘å±•ç½‘ç«™](https://azure.microsoft.com/global-infrastruct/sustainability/?WT.mc_id=academic-17441-jabenn) ä¸Šè¯¦ç»†äº†è§£äº‘æä¾›å•†å¦‚ä½•è‡´åŠ›äºå¯æŒç»­å‘å±•ã€‚

âœ… åšä¸€äº›ç ”ç©¶ï¼šé˜…è¯»ä¸»è¦äº‘ï¼Œä¾‹å¦‚ [Microsoft çš„ Azure](https://azure.microsoft.com/?WT.mc_id=academic-17441-jabenn) æˆ– [Google çš„ GCP](https://cloud.google.com)ã€‚ä»–ä»¬æœ‰å¤šå°‘ä¸ªæ•°æ®ä¸­å¿ƒï¼Ÿå®ƒä»¬ä½äºä¸–ç•Œä½•å¤„ï¼Ÿ

ä½¿ç”¨äº‘å¯ä»¥é™ä½å…¬å¸çš„æˆæœ¬ï¼Œå¹¶ä½¿ä»–ä»¬èƒ½å¤Ÿä¸“æ³¨äºè‡ªå·±æœ€æ“…é•¿çš„äº‹æƒ…ï¼Œä»è€Œå°†äº‘è®¡ç®—ä¸“ä¸šçŸ¥è¯†äº¤åˆ°æä¾›å•†æ‰‹ä¸­ã€‚å…¬å¸ä¸å†éœ€è¦ç§Ÿç”¨æˆ–è´­ä¹°æ•°æ®ä¸­å¿ƒç©ºé—´ã€å‘ä¸åŒçš„æä¾›å•†æ”¯ä»˜è¿æ¥å’Œç”µåŠ›è´¹ç”¨æˆ–è˜è¯·ä¸“å®¶ã€‚ç›¸åï¼Œä»–ä»¬å¯ä»¥æ¯æœˆå‘äº‘æä¾›å•†æ”¯ä»˜ä¸€ä»½è´¦å•ï¼Œä»¥è§£å†³ä¸€åˆ‡é—®é¢˜ã€‚

ç„¶åï¼Œäº‘æä¾›å•†å¯ä»¥åˆ©ç”¨è§„æ¨¡ç»æµæ¥é™ä½æˆæœ¬ï¼Œä»¥è¾ƒä½çš„æˆæœ¬æ‰¹é‡è´­ä¹°è®¡ç®—æœºï¼ŒæŠ•èµ„å·¥å…·ä»¥å‡å°‘ç»´æŠ¤å·¥ä½œé‡ï¼Œç”šè‡³è®¾è®¡å’Œæ„å»ºè‡ªå·±çš„ç¡¬ä»¶æ¥æ”¹è¿›å…¶äº‘äº§å“ã€‚

### å¾®è½¯ Azure

Azure æ˜¯ Microsoft çš„å¼€å‘è€…äº‘ï¼Œæ‚¨å°†åœ¨è¿™äº›è¯¾ç¨‹ä¸­ä½¿ç”¨å®ƒã€‚ä¸‹é¢çš„è§†é¢‘ç®€è¦æ¦‚è¿°äº† Azureï¼š

[![Azure è§†é¢‘æ¦‚è¿°](../../../../images/what-is-azure-video-thumbnail.png)](https://www.microsoft.com/videoplayer/embed/RE4Ibng?WT.mc_id=academic-17441-jabenn)


## åˆ›å»ºäº‘è®¢é˜…

è¦ä½¿ç”¨äº‘ä¸­çš„æœåŠ¡ï¼Œæ‚¨éœ€è¦å‘äº‘æä¾›å•†æ³¨å†Œè®¢é˜…ã€‚åœ¨æœ¬è¯¾ç¨‹ä¸­ï¼Œæ‚¨å°†æ³¨å†Œ Microsoft Azure è®¢é˜…ã€‚å¦‚æœä½ å·²ç»æœ‰ Azure è®¢é˜…ï¼Œåˆ™å¯ä»¥è·³è¿‡æ­¤ä»»åŠ¡ã€‚æ­¤å¤„æè¿°çš„è®¢é˜…è¯¦ç»†ä¿¡æ¯åœ¨æ’°å†™æœ¬æ–‡æ—¶æ­£ç¡®æ— è¯¯ï¼Œä½†å¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–ã€‚

> ğŸ’ å¦‚æœæ‚¨é€šè¿‡å­¦æ ¡è®¿é—®è¿™äº›è¯¾ç¨‹ï¼Œæ‚¨å¯èƒ½å·²ç»æœ‰å¯ç”¨çš„ Azure è®¢é˜…ã€‚è¯·å’¨è¯¢ä½ çš„è€å¸ˆã€‚

æ‚¨å¯ä»¥æ³¨å†Œä¸¤ç§ä¸åŒç±»å‹çš„å…è´¹ Azure è®¢é˜…ï¼š

* **Azure for Students** - è¿™æ˜¯ä¸“ä¸º 18 å²ä»¥ä¸Šå­¦ç”Ÿè®¾è®¡çš„è®¢é˜…ã€‚æ‚¨ä¸éœ€è¦ä¿¡ç”¨å¡å³å¯æ³¨å†Œï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨å­¦æ ¡ç”µå­é‚®ä»¶åœ°å€æ¥éªŒè¯æ‚¨æ˜¯å­¦ç”Ÿã€‚æ³¨å†Œåï¼Œæ‚¨å°†è·å¾— 100 ç¾å…ƒç”¨äºè´­ä¹°äº‘èµ„æºï¼Œä»¥åŠå…è´¹æœåŠ¡ï¼ŒåŒ…æ‹¬å…è´¹ç‰ˆæœ¬çš„ IoT æœåŠ¡ã€‚æœ‰æ•ˆæœŸä¸º 12 ä¸ªæœˆï¼Œæ‚¨å¯ä»¥åœ¨å­¦ç”Ÿèº«ä»½æœŸé—´æ¯å¹´ç»­ç­¾ã€‚

* **Azure å…è´¹è®¢é˜…** - è¿™æ˜¯é¢å‘éå­¦ç”Ÿçš„ä»»ä½•äººçš„è®¢é˜…ã€‚æ‚¨éœ€è¦ä¸€å¼ ä¿¡ç”¨å¡æ¥æ³¨å†Œè®¢é˜…ï¼Œä½†æ‚¨çš„å¡ä¸ä¼šè¢«è®¡è´¹ï¼Œè¿™åªæ˜¯ç”¨æ¥éªŒè¯æ‚¨æ˜¯ä¸€ä¸ªçœŸæ­£çš„äººï¼Œè€Œä¸æ˜¯æœºå™¨äººã€‚æ‚¨å°†è·å¾— 200 ç¾å…ƒçš„ç§¯åˆ†ï¼Œå¯åœ¨å‰ 30 å¤©å†…ä½¿ç”¨ä»»ä½•æœåŠ¡ï¼Œä»¥åŠå…è´¹çš„ Azure æœåŠ¡ã€‚ä¸€æ—¦æ‚¨çš„ä¿¡ç”¨é¢åº¦ç”¨å®Œï¼Œé™¤éæ‚¨è½¬æ¢ä¸ºç°æ”¶ç°ä»˜è®¢é˜…ï¼Œå¦åˆ™ä¸ä¼šä»æ‚¨çš„å¡ä¸­æ‰£è´¹ã€‚

> ğŸ’ Microsoft ç¡®å®ä¸º 18 å²ä»¥ä¸‹çš„å­¦ç”Ÿæä¾› Azure for Students Starter è®¢é˜…ï¼Œä½†åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼Œå®ƒä¸æ”¯æŒä»»ä½• IoT æœåŠ¡ã€‚

### ä»»åŠ¡ - æ³¨å†Œå…è´¹äº‘è®¢é˜…

å¦‚æœä½ æ˜¯ 18 å²ä»¥ä¸Šçš„å­¦ç”Ÿï¼Œåˆ™å¯ä»¥æ³¨å†Œ Azure å­¦ç”Ÿç‰ˆè®¢é˜…ã€‚æ‚¨éœ€è¦ä½¿ç”¨å­¦æ ¡ç”µå­é‚®ä»¶åœ°å€è¿›è¡ŒéªŒè¯ã€‚æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸¤ç§æ–¹å¼ä¹‹ä¸€æ‰§è¡Œæ­¤æ“ä½œï¼š

* åœ¨ [education.github.com/pack](https://education.github.com/pack) æ³¨å†Œ GitHub å­¦ç”Ÿå¼€å‘åŒ…ã€‚è¿™ä½¿æ‚¨å¯ä»¥è®¿é—®ä¸€ç³»åˆ—å·¥å…·å’Œäº§å“ï¼ŒåŒ…æ‹¬ GitHub å’Œ Microsoft Azureã€‚æ³¨å†Œå¼€å‘äººå‘˜åŒ…åï¼Œæ‚¨å°±å¯ä»¥æ¿€æ´»é¢å‘å­¦ç”Ÿçš„ Azure ä¼˜æƒ ã€‚

* ç›´æ¥åœ¨ [azure.microsoft.com/free/students](https://azure.microsoft.com/free/students/?WT.mc_id=academic-17441-jabenn) æ³¨å†Œ Azure for Students å¸æˆ·ã€‚

> âš ï¸ å¦‚æœæ‚¨çš„å­¦æ ¡ç”µå­é‚®ä»¶åœ°å€æ— æ³•è¯†åˆ«ï¼Œè¯·åœ¨æ­¤å­˜å‚¨åº“ä¸­ [æå‡ºé—®é¢˜](https://github.com/Microsoft/IoT-For-Beginners/issues)ï¼Œæˆ‘ä»¬å°†æŸ¥çœ‹æ˜¯å¦å¯ä»¥å°†å…¶æ·»åŠ åˆ°Azure å­¦ç”Ÿå…è®¸åˆ—è¡¨ã€‚

å¦‚æœä½ ä¸æ˜¯å­¦ç”Ÿï¼Œæˆ–è€…æ²¡æœ‰æœ‰æ•ˆçš„å­¦æ ¡ç”µå­é‚®ä»¶åœ°å€ï¼Œåˆ™å¯ä»¥æ³¨å†Œ Azure å…è´¹è®¢é˜…ã€‚

* åœ¨ [azure.microsoft.com/free](https://azure.microsoft.com/free/?WT.mc_id=academic-17441-jabenn) æ³¨å†Œ Azure å…è´¹è®¢é˜…

## äº‘ç‰©è”ç½‘æœåŠ¡

æ‚¨ä¸€ç›´åœ¨ä½¿ç”¨çš„å…¬å…±æµ‹è¯• MQTT ä»£ç†åœ¨å­¦ä¹ æ—¶æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å·¥å…·ï¼Œä½†ä½œä¸ºåœ¨å•†ä¸šç¯å¢ƒä¸­ä½¿ç”¨çš„å·¥å…·æœ‰è®¸å¤šç¼ºç‚¹ï¼š

* å¯é æ€§ - è¿™æ˜¯ä¸€é¡¹å…è´¹æœåŠ¡ï¼Œæ²¡æœ‰ä»»ä½•ä¿è¯ï¼Œå¹¶ä¸”å¯ä»¥éšæ—¶å…³é—­
* å®‰å…¨æ€§ - å®ƒæ˜¯å…¬å¼€çš„ï¼Œå› æ­¤ä»»ä½•äººéƒ½å¯ä»¥ç›‘å¬æ‚¨çš„é¥æµ‹æˆ–å‘é€å‘½ä»¤æ¥æ§åˆ¶æ‚¨çš„ç¡¬ä»¶
* æ€§èƒ½ - å®ƒä»…é’ˆå¯¹å°‘é‡æµ‹è¯•æ¶ˆæ¯è€Œè®¾è®¡ï¼Œå› æ­¤æ— æ³•åº”å¯¹å‘é€çš„å¤§é‡æ¶ˆæ¯
* å‘ç° - æ— æ³•çŸ¥é“è¿æ¥äº†å“ªäº›è®¾å¤‡

äº‘ä¸­çš„ç‰©è”ç½‘æœåŠ¡è§£å†³äº†è¿™äº›é—®é¢˜ã€‚å®ƒä»¬ç”±å¤§å‹äº‘æä¾›å•†ç»´æŠ¤ï¼Œä»–ä»¬åœ¨å¯é æ€§æ–¹é¢æŠ•å…¥å·¨èµ„ï¼Œå¹¶éšæ—¶è§£å†³å¯èƒ½å‡ºç°çš„ä»»ä½•é—®é¢˜ã€‚å®ƒä»¬å…·æœ‰å†…ç½®çš„å®‰å…¨åŠŸèƒ½ï¼Œå¯ä»¥é˜»æ­¢é»‘å®¢è¯»å–æ‚¨çš„æ•°æ®æˆ–å‘é€æ¶æ„å‘½ä»¤ã€‚å®ƒä»¬è¿˜å…·æœ‰é«˜æ€§èƒ½ï¼Œæ¯å¤©èƒ½å¤Ÿå¤„ç†æ•°ç™¾ä¸‡æ¡æ¶ˆæ¯ï¼Œå¹¶åˆ©ç”¨äº‘æ ¹æ®éœ€è¦è¿›è¡Œæ‰©å±•ã€‚

> ğŸ’ å°½ç®¡æ‚¨éœ€è¦æŒ‰æœˆä»˜è´¹æ‰èƒ½è·å¾—è¿™äº›å¥½å¤„ï¼Œä½†å¤§å¤šæ•°äº‘æä¾›å•†éƒ½æä¾›å…è´¹ç‰ˆæœ¬çš„ç‰©è”ç½‘æœåŠ¡ï¼Œæ¯å¤©çš„æ¶ˆæ¯æ•°é‡æˆ–å¯è¿æ¥çš„è®¾å¤‡æ•°é‡æœ‰é™ã€‚è¿™ä¸ªå…è´¹ç‰ˆæœ¬é€šå¸¸è¶³ä»¥è®©å¼€å‘äººå‘˜äº†è§£è¯¥æœåŠ¡ã€‚åœ¨æœ¬è¯¾ç¨‹ä¸­ï¼Œæ‚¨å°†ä½¿ç”¨å…è´¹ç‰ˆæœ¬ã€‚

IoT è®¾å¤‡ä½¿ç”¨è®¾å¤‡ SDKï¼ˆæä¾›ä½¿ç”¨æœåŠ¡åŠŸèƒ½çš„ä»£ç çš„åº“ï¼‰æˆ–ç›´æ¥é€šè¿‡ MQTT æˆ– HTTP ç­‰é€šä¿¡åè®®è¿æ¥åˆ°äº‘æœåŠ¡ã€‚è®¾å¤‡ SDK é€šå¸¸æ˜¯æœ€ç®€å•çš„é€”å¾„ï¼Œå› ä¸ºå®ƒä¼šä¸ºæ‚¨å¤„ç†æ‰€æœ‰äº‹æƒ…ï¼Œä¾‹å¦‚äº†è§£è¦å‘å¸ƒæˆ–è®¢é˜…å“ªäº›ä¸»é¢˜ä»¥åŠå¦‚ä½•å¤„ç†å®‰å…¨æ€§ã€‚

![è®¾å¤‡ä½¿ç”¨è®¾å¤‡ SDK è¿æ¥åˆ°æœåŠ¡ã€‚æœåŠ¡å™¨ä»£ç è¿˜é€šè¿‡ SDK è¿æ¥åˆ°æœåŠ¡](../../../../images/iot-service-connectivity.png)

ç„¶åï¼Œæ‚¨çš„è®¾å¤‡é€šè¿‡æ­¤æœåŠ¡ä¸åº”ç”¨ç¨‹åºçš„å…¶ä»–éƒ¨åˆ†è¿›è¡Œé€šä¿¡ - ç±»ä¼¼äºé€šè¿‡ MQTT å‘é€é¥æµ‹æ•°æ®å’Œæ¥æ”¶å‘½ä»¤çš„æ–¹å¼ã€‚è¿™é€šå¸¸ä½¿ç”¨æœåŠ¡ SDK æˆ–ç±»ä¼¼çš„åº“ã€‚æ¶ˆæ¯ä»æ‚¨çš„è®¾å¤‡å‘é€åˆ°æœåŠ¡ï¼Œç„¶ååº”ç”¨ç¨‹åºçš„å…¶ä»–ç»„ä»¶å¯ä»¥è¯»å–å®ƒä»¬ï¼Œç„¶åæ¶ˆæ¯å¯ä»¥å‘é€å›æ‚¨çš„è®¾å¤‡ã€‚

![æ²¡æœ‰æœ‰æ•ˆå¯†é’¥çš„è®¾å¤‡æ— æ³•è¿æ¥åˆ° IoT æœåŠ¡](../../../../images/iot-service-allowed-denied-connection.png)

è¿™äº›æœåŠ¡é€šè¿‡äº†è§£å¯ä»¥è¿æ¥å’Œå‘é€æ•°æ®çš„æ‰€æœ‰è®¾å¤‡æ¥å®ç°å®‰å…¨æ€§ï¼Œæ–¹æ³•æ˜¯è®©è®¾å¤‡é¢„å…ˆæ³¨å†Œåˆ°æœåŠ¡ï¼Œæˆ–è€…å‘è®¾å¤‡æä¾›å¯ç”¨äºé¦–æ¬¡å‘æœåŠ¡æ³¨å†Œçš„è®¾å¤‡å¯†é’¥æˆ–è¯ä¹¦ã€‚ä»–ä»¬è¿æ¥ã€‚æœªçŸ¥è®¾å¤‡æ— æ³•è¿æ¥ï¼Œå¦‚æœå®ƒä»¬å°è¯•ï¼ŒæœåŠ¡ä¼šæ‹’ç»è¿æ¥å¹¶å¿½ç•¥å®ƒä»¬å‘é€çš„æ¶ˆæ¯ã€‚

âœ… åšä¸€äº›ç ”ç©¶ï¼šæ‹¥æœ‰ä»»ä½•è®¾å¤‡æˆ–ä»£ç éƒ½å¯ä»¥è¿æ¥çš„å¼€æ”¾ç‰©è”ç½‘æœåŠ¡æœ‰ä»€ä¹ˆç¼ºç‚¹ï¼Ÿæ‚¨èƒ½æ‰¾åˆ°é»‘å®¢åˆ©ç”¨è¿™ä¸€ç‚¹çš„å…·ä½“ä¾‹å­å—ï¼Ÿ

åº”ç”¨ç¨‹åºçš„å…¶ä»–ç»„ä»¶å¯ä»¥è¿æ¥åˆ° IoT æœåŠ¡å¹¶äº†è§£æ‰€æœ‰è¿æ¥æˆ–æ³¨å†Œçš„è®¾å¤‡ï¼Œå¹¶ç›´æ¥æ‰¹é‡æˆ–å•ç‹¬ä¸å®ƒä»¬é€šä¿¡ã€‚

> ğŸ’ ç‰©è”ç½‘æœåŠ¡è¿˜å®ç°äº†é¢å¤–çš„åŠŸèƒ½ï¼Œå¹¶ä¸”äº‘æä¾›å•†æ‹¥æœ‰å¯ä»¥è¿æ¥åˆ°è¯¥æœåŠ¡çš„é¢å¤–æœåŠ¡å’Œåº”ç”¨ç¨‹åºã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æƒ³è¦å°†æ‰€æœ‰è®¾å¤‡å‘é€çš„æ‰€æœ‰é¥æµ‹æ¶ˆæ¯å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œé€šå¸¸åªéœ€åœ¨äº‘æä¾›å•†çš„é…ç½®å·¥å…·ä¸­å•å‡»å‡ ä¸‹å³å¯å°†æœåŠ¡è¿æ¥åˆ°æ•°æ®åº“å¹¶å°†æ•°æ®æµå¼ä¼ è¾“ã€‚

## åœ¨äº‘ç«¯åˆ›å»º IoT æœåŠ¡

ç°åœ¨æ‚¨å·²æ‹¥æœ‰ Azure è®¢é˜…ï¼Œæ‚¨å¯ä»¥æ³¨å†Œ IoT æœåŠ¡ã€‚ Microsoft çš„ IoT æœåŠ¡ç§°ä¸º Azure IoT Hubã€‚

![Azure IoT ä¸­å¿ƒå¾½æ ‡](../../../../images/azure-iot-hub-logo.png)

ä¸‹é¢çš„è§†é¢‘ç®€è¦æ¦‚è¿°äº† Azure IoT ä¸­å¿ƒï¼š

[![Azure IoT ä¸­å¿ƒè§†é¢‘æ¦‚è¿°](https://img.youtube.com/vi/smuZaZZXKsU/0.jpg)](https://www.youtube.com/watch?v=smuZaZZXKsU)

> ğŸ¥ ç‚¹å‡»ä¸Šå›¾è§‚çœ‹è§†é¢‘

âœ… èŠ±ç‚¹æ—¶é—´åšä¸€äº›ç ”ç©¶å¹¶é˜…è¯» [Microsoft IoT ä¸­å¿ƒæ–‡æ¡£](https://docs.microsoft.com/azure/iot-hub/about-iot-hub?WT.mc_id=å­¦æœ¯-17441-jabenn)ã€‚

Azure ä¸­æä¾›çš„äº‘æœåŠ¡å¯ä»¥é€šè¿‡åŸºäº Web çš„é—¨æˆ·æˆ–å‘½ä»¤è¡Œç•Œé¢ (CLI) è¿›è¡Œé…ç½®ã€‚å¯¹äºæ­¤ä»»åŠ¡ï¼Œæ‚¨å°†ä½¿ç”¨ CLIã€‚

### ä»»åŠ¡ - å®‰è£… Azure CLI

è¦ä½¿ç”¨ Azure CLIï¼Œé¦–å…ˆå¿…é¡»å°†å…¶å®‰è£…åœ¨ PC æˆ– Mac ä¸Šã€‚

1. æŒ‰ç…§ [Azure CLI æ–‡æ¡£](https://docs.microsoft.com/cli/azure/install-azure-cli?WT.mc_id=academic-17441-jabenn) ä¸­çš„è¯´æ˜å®‰è£… CLIã€‚

1. Azure CLI æ”¯æŒè®¸å¤šæ‰©å±•ï¼Œè¿™äº›æ‰©å±•å¢åŠ äº†ç®¡ç†å„ç§ Azure æœåŠ¡çš„åŠŸèƒ½ã€‚é€šè¿‡ä»å‘½ä»¤è¡Œæˆ–ç»ˆç«¯è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥å®‰è£… IoT æ‰©å±•ï¼š

    ```sh
    az extension add --name azure-iot
    ```

1. åœ¨å‘½ä»¤è¡Œæˆ–ç»ˆç«¯ä¸­ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ä»¥ä» Azure CLI ç™»å½•åˆ° Azure è®¢é˜…ã€‚

    ```sh
    az login
    ```

    å°†åœ¨æ‚¨çš„é»˜è®¤æµè§ˆå™¨ä¸­å¯åŠ¨ä¸€ä¸ªç½‘é¡µã€‚ä½¿ç”¨ç”¨äºæ³¨å†Œ Azure è®¢é˜…çš„å¸æˆ·ç™»å½•ã€‚ç™»å½•åï¼Œæ‚¨å¯ä»¥å…³é—­æµè§ˆå™¨é€‰é¡¹å¡ã€‚

1. å¦‚æœæ‚¨æœ‰å¤šä¸ª Azure è®¢é˜…ï¼ˆä¾‹å¦‚å­¦æ ¡æä¾›çš„è®¢é˜…ï¼‰å’Œæ‚¨è‡ªå·±çš„ Azure for Students è®¢é˜…ï¼Œåˆ™éœ€è¦é€‰æ‹©è¦ä½¿ç”¨çš„è®¢é˜…ã€‚è¿è¡Œä»¥ä¸‹å‘½ä»¤åˆ—å‡ºæ‚¨æœ‰æƒè®¿é—®çš„æ‰€æœ‰è®¢é˜…ï¼š
    
    ```sh
    az account list --output table
    ```

    åœ¨è¾“å‡ºä¸­ï¼Œæ‚¨å°†çœ‹åˆ°æ¯ä¸ªè®¢é˜…çš„åç§°åŠå…¶ `SubscriptionId`ã€‚

    ```output
    âœ  ~ az account list --output table
    Name                    CloudName    SubscriptionId                        State    IsDefault
    ----------------------  -----------  ------------------------------------  -------  -----------
    School-subscription     AzureCloud   cb30cde9-814a-42f0-a111-754cb788e4e1  Enabled  True
    Azure for Students      AzureCloud   fa51c31b-162c-4599-add6-781def2e1fbf  Enabled  False
    ```

    è¦é€‰æ‹©æ‚¨è¦ä½¿ç”¨çš„è®¢é˜…ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š

    ```sh
    az account set --subscription <SubscriptionId>
    ```

    æ›¿æ¢ `SubscriptionID`  ä¸ºæ‚¨è¦ä½¿ç”¨çš„è®¢é˜…çš„ IDã€‚è¿è¡Œæ­¤å‘½ä»¤åï¼Œé‡æ–°è¿è¡Œè¯¥å‘½ä»¤ä»¥åˆ—å‡ºæ‚¨çš„å¸æˆ·ã€‚æ‚¨å°†çœ‹åˆ°æ‚¨åˆšåˆšè®¾ç½®çš„è®¢é˜…çš„ `IsDefault`  åˆ—å°†è¢«æ ‡è®°ä¸º`True`  ã€‚

### ä»»åŠ¡ - åˆ›å»ºèµ„æºç»„

Azure æœåŠ¡ï¼ˆä¾‹å¦‚ IoT ä¸­å¿ƒå®ä¾‹ã€è™šæ‹Ÿæœºã€æ•°æ®åº“æˆ– AI æœåŠ¡ï¼‰è¢«ç§°ä¸º**èµ„æº**ã€‚æ¯ä¸ªèµ„æºéƒ½å¿…é¡»ä½äº**èµ„æºç»„**å†…ï¼Œå³ä¸€ä¸ªæˆ–å¤šä¸ªèµ„æºçš„é€»è¾‘åˆ†ç»„ã€‚

> ğŸ’ ä½¿ç”¨èµ„æºç»„æ„å‘³ç€æ‚¨å¯ä»¥åŒæ—¶ç®¡ç†å¤šä¸ªæœåŠ¡ã€‚ä¾‹å¦‚ï¼Œå½“æ‚¨å®Œæˆè¯¥é¡¹ç›®çš„æ‰€æœ‰è¯¾ç¨‹åï¼Œæ‚¨å¯ä»¥åˆ é™¤è¯¥èµ„æºç»„ï¼Œå…¶ä¸­çš„æ‰€æœ‰èµ„æºå°†è¢«è‡ªåŠ¨åˆ é™¤ã€‚

1. å…¨çƒæœ‰å¤šä¸ªAzureæ•°æ®ä¸­å¿ƒï¼Œåˆ†ä¸ºå¤šä¸ªåŒºåŸŸã€‚åˆ›å»º Azure èµ„æºæˆ–èµ„æºç»„æ—¶ï¼Œå¿…é¡»æŒ‡å®šåˆ›å»ºä½ç½®ã€‚è¿è¡Œä»¥ä¸‹å‘½ä»¤ä»¥è·å–ä½ç½®åˆ—è¡¨ï¼š

    ```sh
    az account list-locations --output table
    ```

    æ‚¨å°†çœ‹åˆ°ä½ç½®åˆ—è¡¨ã€‚è¿™ä¸ªæ¸…å•ä¼šå¾ˆé•¿ã€‚

    > ğŸ’ åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼Œæ‚¨å¯ä»¥éƒ¨ç½²åˆ° 65 ä¸ªä½ç½®ã€‚

    ```output
        âœ  ~ az account list-locations --output table
    DisplayName               Name                 RegionalDisplayName
    ------------------------  -------------------  -------------------------------------
    East US                   eastus               (US) East US
    East US 2                 eastus2              (US) East US 2
    South Central US          southcentralus       (US) South Central US
    ...
    ```

    è®°ä¸‹ç¦»æ‚¨æœ€è¿‘çš„åŒºåŸŸçš„`Name`  åˆ—ä¸­çš„å€¼ã€‚æ‚¨å¯ä»¥åœ¨ [Azure åœ°ç†é¡µé¢](https://azure.microsoft.com/global-infrastruct/geographies/?WT.mc_id=academic-17441-jabenn) ä¸Šçš„åœ°å›¾ä¸Šæ‰¾åˆ°è¿™äº›åŒºåŸŸã€‚

1. è¿è¡Œä»¥ä¸‹å‘½ä»¤åˆ›å»ºåä¸º `soil-moisture-sensor`  çš„èµ„æºç»„ã€‚èµ„æºç»„åç§°åœ¨æ‚¨çš„è®¢é˜…ä¸­å¿…é¡»æ˜¯å”¯ä¸€çš„ã€‚

     ```sh
    az group create --name soil-moisture-sensor \
                    --location <location>
    ```

    æ›¿æ¢ `loction`  ä¸ºæ‚¨åœ¨ä¸Šä¸€æ­¥ä¸­é€‰æ‹©çš„ä½ç½®ã€‚

### ä»»åŠ¡ - åˆ›å»º IoT ä¸­å¿ƒ

ç°åœ¨ï¼Œæ‚¨å¯ä»¥åœ¨èµ„æºç»„ä¸­åˆ›å»º IoT ä¸­å¿ƒèµ„æºã€‚

1. ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ›å»º IoT ä¸­å¿ƒèµ„æºï¼š

    ```sh
    az iot hub create --resource-group soil-moisture-sensor \
                      --sku F1 \
                      --partition-count 2 \
                      --name <hub_name>
    ```

     å°† `<hub_name>` æ›¿æ¢ä¸ºæ‚¨çš„é›†çº¿å™¨çš„åç§°ã€‚ è¯¥åç§°å¿…é¡»æ˜¯å…¨å±€å”¯ä¸€çš„ - å³ä»»ä½•äººåˆ›å»ºçš„å…¶ä»– IoT ä¸­å¿ƒéƒ½ä¸èƒ½å…·æœ‰ç›¸åŒçš„åç§°ã€‚ æ­¤åç§°åœ¨æŒ‡å‘ä¸­å¿ƒçš„ URL ä¸­ä½¿ç”¨ï¼Œå› æ­¤éœ€è¦æ˜¯å”¯ä¸€çš„ã€‚ ä½¿ç”¨`soil-moisture-sensor`  ä¹‹ç±»çš„ä¸œè¥¿ï¼Œå¹¶åœ¨æœ«å°¾æ·»åŠ ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼Œä¾‹å¦‚ä¸€äº›éšæœºå•è¯æˆ–æ‚¨çš„åå­—ã€‚

     `--sku F1` é€‰é¡¹å‘Šè¯‰å®ƒä½¿ç”¨å…è´¹å¥—é¤ã€‚ å…è´¹å¥—é¤æ¯å¤©æ”¯æŒ 8,000 æ¡æ¶ˆæ¯ä»¥åŠå…¨ä»·å¥—é¤çš„å¤§éƒ¨åˆ†åŠŸèƒ½ã€‚

     > ğŸ“ Azure æœåŠ¡çš„ä¸åŒå®šä»·çº§åˆ«ç§°ä¸ºå±‚çº§ã€‚ æ¯ä¸ªå±‚éƒ½æœ‰ä¸åŒçš„æˆæœ¬å¹¶æä¾›ä¸åŒçš„åŠŸèƒ½æˆ–æ•°æ®é‡ã€‚

     > ğŸ’ å¦‚æœæ‚¨æƒ³äº†è§£æ›´å¤šå®šä»·ä¿¡æ¯ï¼Œå¯ä»¥æŸ¥çœ‹ [Azure IoT Hubå®šä»·æŒ‡å—](https://azure.microsoft.com/pricing/details/iot-hub/?WT.mc_id=academic-17441-jabenn).

     `--partition-count 2` é€‰é¡¹å®šä¹‰äº† IoT ä¸­å¿ƒæ”¯æŒå¤šå°‘ä¸ªæ•°æ®æµï¼Œæ›´å¤šçš„åˆ†åŒºå¯ä»¥å‡å°‘å¤šä¸ªäº‹ç‰©ä» IoT ä¸­å¿ƒè¯»å†™æ—¶çš„æ•°æ®é˜»å¡ã€‚ åˆ†åŒºä¸åœ¨è¿™äº›è¯¾ç¨‹çš„èŒƒå›´å†…ï¼Œä½†éœ€è¦è®¾ç½®æ­¤å€¼æ‰èƒ½åˆ›å»ºå…è´¹å±‚ IoT ä¸­å¿ƒã€‚

     > ğŸ’ æ¯ä¸ªè®¢é˜…åªèƒ½æ‹¥æœ‰ä¸€ä¸ªå…è´¹çš„ IoT ä¸­å¿ƒã€‚

å°†åˆ›å»º IoT ä¸­å¿ƒã€‚ è¿™éœ€è¦ä¸€åˆ†é’Ÿå·¦å³æ‰èƒ½å®Œæˆã€‚

## ä¸ IoT ä¸­å¿ƒé€šä¿¡

åœ¨ä¸Šä¸€è¯¾ä¸­ï¼Œæ‚¨ä½¿ç”¨äº† MQTT å¹¶å°±ä¸åŒçš„ä¸»é¢˜æ¥å›å‘é€æ¶ˆæ¯ï¼Œä¸åŒçš„ä¸»é¢˜æœ‰ä¸åŒçš„ç”¨é€”ã€‚ IoT ä¸­å¿ƒä¸æ˜¯é€šè¿‡ä¸åŒçš„ä¸»é¢˜å‘é€æ¶ˆæ¯ï¼Œè€Œæ˜¯ä¸ºè®¾å¤‡ä¸é›†çº¿å™¨é€šä¿¡æˆ–é›†çº¿å™¨ä¸è®¾å¤‡é€šä¿¡æä¾›äº†å¤šç§å®šä¹‰çš„æ–¹å¼ã€‚

> ğŸ’ åœ¨åº•å±‚ï¼ŒIoT ä¸­å¿ƒå’Œæ‚¨çš„è®¾å¤‡ä¹‹é—´çš„é€šä¿¡å¯ä»¥ä½¿ç”¨ MQTTã€HTTPS æˆ– AMQPã€‚

* è®¾å¤‡åˆ°äº‘ (D2C) æ¶ˆæ¯ - è¿™äº›æ˜¯ä»è®¾å¤‡å‘é€åˆ° IoT ä¸­å¿ƒçš„æ¶ˆæ¯ï¼Œä¾‹å¦‚é¥æµ‹ã€‚ ç„¶åï¼Œæ‚¨çš„åº”ç”¨ç¨‹åºä»£ç å¯ä»¥ä» IoT ä¸­å¿ƒè¯»å–å®ƒä»¬ã€‚

     > ğŸ“ åœ¨åº•å±‚ï¼ŒIoT ä¸­å¿ƒä½¿ç”¨åä¸º [äº‹ä»¶ä¸­å¿ƒ](https://docs.microsoft.com/azure/event-hubs/?WT.mc_id=academic-17441-jabenn) çš„ Azure æœåŠ¡ã€‚ å½“æ‚¨ç¼–å†™ä»£ç æ¥è¯»å–å‘é€åˆ°é›†çº¿å™¨çš„æ¶ˆæ¯æ—¶ï¼Œè¿™äº›æ¶ˆæ¯é€šå¸¸ç§°ä¸ºäº‹ä»¶ã€‚

* äº‘åˆ°è®¾å¤‡ (C2D) æ¶ˆæ¯ - è¿™äº›æ˜¯ä»åº”ç”¨ç¨‹åºä»£ç é€šè¿‡ IoT ä¸­å¿ƒå‘é€åˆ° IoT è®¾å¤‡çš„æ¶ˆæ¯

* ç›´æ¥æ–¹æ³•è¯·æ±‚ - è¿™äº›æ˜¯ä»åº”ç”¨ç¨‹åºä»£ç é€šè¿‡ IoT ä¸­å¿ƒå‘é€åˆ° IoT è®¾å¤‡çš„æ¶ˆæ¯ï¼Œä»¥è¯·æ±‚è®¾å¤‡æ‰§è¡ŒæŸäº›æ“ä½œï¼Œä¾‹å¦‚æ§åˆ¶æ‰§è¡Œå™¨ã€‚ è¿™äº›æ¶ˆæ¯éœ€è¦å“åº”ï¼Œä»¥ä¾¿æ‚¨çš„åº”ç”¨ç¨‹åºä»£ç å¯ä»¥åˆ¤æ–­æ˜¯å¦å·²æˆåŠŸå¤„ç†ã€‚

* è®¾å¤‡å­ªç”Ÿ - è¿™äº›æ˜¯åœ¨è®¾å¤‡å’Œ IoT ä¸­å¿ƒä¹‹é—´ä¿æŒåŒæ­¥çš„ JSON æ–‡æ¡£ï¼Œç”¨äºå­˜å‚¨è®¾å¤‡æŠ¥å‘Šçš„è®¾ç½®æˆ–å…¶ä»–å±æ€§ï¼Œæˆ–è€…åº”ç”± IoT ä¸­å¿ƒåœ¨è®¾å¤‡ä¸Šè®¾ç½®ï¼ˆç§°ä¸ºæ‰€éœ€ï¼‰ã€‚

IoT ä¸­å¿ƒå¯ä»¥åœ¨å¯é…ç½®çš„æ—¶é—´æ®µï¼ˆé»˜è®¤ä¸ºä¸€å¤©ï¼‰å†…å­˜å‚¨æ¶ˆæ¯å’Œç›´æ¥æ–¹æ³•è¯·æ±‚ï¼Œå› æ­¤ï¼Œå¦‚æœè®¾å¤‡æˆ–åº”ç”¨ç¨‹åºä»£ç å¤±å»è¿æ¥ï¼Œå®ƒåœ¨é‡æ–°è¿æ¥åä»ç„¶å¯ä»¥æ£€ç´¢ç¦»çº¿æ—¶å‘é€çš„æ¶ˆæ¯ã€‚ è®¾å¤‡å­ªç”Ÿæ°¸ä¹…ä¿å­˜åœ¨ IoT ä¸­å¿ƒï¼Œå› æ­¤è®¾å¤‡å¯ä»¥éšæ—¶é‡æ–°è¿æ¥å¹¶è·å–æœ€æ–°çš„è®¾å¤‡å­ªç”Ÿã€‚

âœ… åšä¸€äº›ç ”ç©¶ï¼šåœ¨ IoT ä¸­å¿ƒæ–‡æ¡£ä¸­é˜…è¯»æœ‰å…³è¿™äº›æ¶ˆæ¯ç±»å‹çš„æ›´å¤šä¿¡æ¯: [è®¾å¤‡åˆ°äº‘é€šä¿¡æŒ‡å—](https://docs.microsoft.com/azure/iot-hub/iot-hub-devguide-d2c-guidance?WT.mc_id=academic-17441-jabenn)ï¼Œä»¥åŠ[äº‘åˆ°è®¾å¤‡é€šä¿¡æŒ‡å—](https://docs.microsoft.com/azure/iot-hub/iot-hub-devguide-c2d-guidance?WT.mc_id=academic-17441-jabenn) ã€‚

## å°†æ‚¨çš„è®¾å¤‡è¿æ¥åˆ° IoT æœåŠ¡

åˆ›å»ºä¸­å¿ƒåï¼Œæ‚¨çš„ IoT è®¾å¤‡å°±å¯ä»¥è¿æ¥åˆ°å®ƒã€‚ åªæœ‰æ³¨å†Œçš„è®¾å¤‡æ‰èƒ½è¿æ¥åˆ°æœåŠ¡ï¼Œå› æ­¤æ‚¨éœ€è¦å…ˆæ³¨å†Œæ‚¨çš„è®¾å¤‡ã€‚ æ³¨å†Œæ—¶ï¼Œæ‚¨å¯ä»¥è·å¾—è®¾å¤‡å¯ç”¨äºè¿æ¥çš„è¿æ¥å­—ç¬¦ä¸²ã€‚ æ­¤è¿æ¥å­—ç¬¦ä¸²æ˜¯è®¾å¤‡ç‰¹å®šçš„ï¼ŒåŒ…å«æœ‰å…³ IoT ä¸­å¿ƒã€è®¾å¤‡ä»¥åŠå…è®¸è¯¥è®¾å¤‡è¿æ¥çš„å¯†é’¥çš„ä¿¡æ¯ã€‚

> ğŸ“ è¿æ¥å­—ç¬¦ä¸²æ˜¯åŒ…å«è¿æ¥è¯¦ç»†ä¿¡æ¯çš„ä¸€æ®µæ–‡æœ¬çš„é€šç”¨æœ¯è¯­ã€‚ è¿™äº›åœ¨è¿æ¥åˆ° IoT ä¸­å¿ƒã€æ•°æ®åº“å’Œè®¸å¤šå…¶ä»–æœåŠ¡æ—¶ä½¿ç”¨ã€‚ å®ƒä»¬é€šå¸¸ç”±æœåŠ¡æ ‡è¯†ç¬¦ï¼ˆä¾‹å¦‚ URLï¼‰å’Œå®‰å…¨ä¿¡æ¯ï¼ˆä¾‹å¦‚å¯†é’¥ï¼‰ç»„æˆã€‚ è¿™äº›å°†ä¼ é€’ç»™ SDK ä»¥è¿æ¥åˆ°æœåŠ¡ã€‚

> âš ï¸ è¿æ¥å­—ç¬¦ä¸²åº”ä¿æŒå®‰å…¨ï¼ å®‰å…¨æ€§å°†åœ¨ä»¥åçš„è¯¾ç¨‹ä¸­æ›´è¯¦ç»†åœ°ä»‹ç»ã€‚

### ä»»åŠ¡ - æ³¨å†Œæ‚¨çš„ IoT è®¾å¤‡

å¯ä»¥ä½¿ç”¨ Azure CLI å‘ IoT ä¸­å¿ƒæ³¨å†Œ IoT è®¾å¤‡ã€‚

1. è¿è¡Œä»¥ä¸‹å‘½ä»¤æ³¨å†Œè®¾å¤‡ï¼š

    ```sh
    az iot hub device-identity create --device-id soil-moisture-sensor \
                                      --hub-name <hub_name>
    ```

    å°† `<hub_name>` æ›¿æ¢ä¸ºæ‚¨ç”¨äº IoT ä¸­å¿ƒçš„åç§°ã€‚

    è¿™å°†åˆ›å»ºä¸€ä¸ª ID ä¸º`soil-moisture-sensor`  çš„è®¾å¤‡ã€‚

1. å½“æ‚¨çš„ IoT è®¾å¤‡ä½¿ç”¨ SDK è¿æ¥åˆ° IoT ä¸­å¿ƒæ—¶ï¼Œå®ƒéœ€è¦ä½¿ç”¨æä¾›ä¸­å¿ƒ URL çš„è¿æ¥å­—ç¬¦ä¸²ä»¥åŠå¯†é’¥ã€‚ è¿è¡Œä»¥ä¸‹å‘½ä»¤è·å–è¿æ¥å­—ç¬¦ä¸²ï¼š

    ```sh
    az iot hub device-identity connection-string show --device-id soil-moisture-sensor \
                                                      --output table \
                                                      --hub-name <hub_name>
    ```

     å°† `<hub_name>` æ›¿æ¢ä¸ºæ‚¨ç”¨äº IoT ä¸­å¿ƒçš„åç§°ã€‚

1. å­˜å‚¨è¾“å‡ºä¸­æ˜¾ç¤ºçš„è¿æ¥å­—ç¬¦ä¸²ï¼Œç¨åæ‚¨å°†éœ€è¦å®ƒã€‚

### ä»»åŠ¡ - å°†æ‚¨çš„ IoT è®¾å¤‡è¿æ¥åˆ°äº‘ç«¯

å®Œæˆç›¸å…³æŒ‡å—å°†æ‚¨çš„ IoT è®¾å¤‡è¿æ¥åˆ°äº‘ï¼š

* [Arduino - Wio ç»ˆç«¯](../wio-terminal-connect-hub.md)
* [å•æ¿è®¡ç®—æœº-Raspberry Pi/è™šæ‹Ÿç‰©è”ç½‘è®¾å¤‡](../single-board-computer-connect-hub.md)

### ä»»åŠ¡ - ç›‘è§†äº‹ä»¶

ç›®å‰ï¼Œæ‚¨ä¸ä¼šæ›´æ–°æœåŠ¡å™¨ä»£ç ã€‚ ç›¸åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ Azure CLI æ¥ç›‘è§†æ¥è‡ª IoT è®¾å¤‡çš„äº‹ä»¶ã€‚

1. ç¡®ä¿æ‚¨çš„ç‰©è”ç½‘è®¾å¤‡æ­£åœ¨è¿è¡Œå¹¶å‘é€åœŸå£¤æ¹¿åº¦é¥æµ‹å€¼

1. åœ¨å‘½ä»¤æç¤ºç¬¦æˆ–ç»ˆç«¯ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥ç›‘æ§å‘é€åˆ° IoT ä¸­å¿ƒçš„æ¶ˆæ¯ï¼š

    ```sh
    az iot hub monitor-events --hub-name <hub_name>
    ```

     å°† `<hub_name>` æ›¿æ¢ä¸ºæ‚¨ç”¨äº IoT ä¸­å¿ƒçš„åç§°ã€‚

     æ‚¨å°†çœ‹åˆ°ç”± IoT è®¾å¤‡å‘é€çš„æ¶ˆæ¯å‡ºç°åœ¨æ§åˆ¶å°è¾“å‡ºä¸­ã€‚

    ```output
    Starting event monitor, use ctrl-c to stop...
    {
        "event": {
            "origin": "soil-moisture-sensor",
            "module": "",
            "interface": "",
            "component": "",
            "payload": "{\"soil_moisture\": 376}"
        }
    },
    {
        "event": {
            "origin": "soil-moisture-sensor",
            "module": "",
            "interface": "",
            "component": "",
            "payload": "{\"soil_moisture\": 381}"
        }
    }
    ```

     `payload`  çš„å†…å®¹å°†ä¸æ‚¨çš„ IoT è®¾å¤‡å‘é€çš„æ¶ˆæ¯åŒ¹é…ã€‚

     > åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼Œ`az iot`  æ‰©å±•å°šæœªåœ¨ Apple Silicon ä¸Šå®Œå…¨è¿è¡Œã€‚ å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯ Apple Silicon è®¾å¤‡ï¼Œåˆ™éœ€è¦ä»¥ä¸åŒçš„æ–¹å¼ç›‘è§†æ¶ˆæ¯ï¼Œä¾‹å¦‚ä½¿ç”¨ [é€‚ç”¨äº Visual Studio Code çš„ Azure IoT å·¥å…·](https://docs.microsoft.com/en-us/azure/iot-hub/iot-hub-vscode-iot-toolkit-cloud-device-messaging)ã€‚


1. è¿™äº›æ¶ˆæ¯è‡ªåŠ¨é™„åŠ äº†è®¸å¤šå±æ€§ï¼Œä¾‹å¦‚å‘é€çš„æ—¶é—´æˆ³ã€‚ è¿™äº›è¢«ç§°ä¸º*æ³¨é‡Š*ã€‚ è¦æŸ¥çœ‹æ‰€æœ‰æ¶ˆæ¯æ³¨é‡Šï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š

    ```sh
    az iot hub monitor-events --properties anno --hub-name <hub_name>
    ```

     å°† `<hub_name>` æ›¿æ¢ä¸ºæ‚¨ç”¨äº IoT ä¸­å¿ƒçš„åç§°ã€‚

     æ‚¨å°†çœ‹åˆ°ç”± IoT è®¾å¤‡å‘é€çš„æ¶ˆæ¯å‡ºç°åœ¨æ§åˆ¶å°è¾“å‡ºä¸­ã€‚

    ```output
    Starting event monitor, use ctrl-c to stop...
    {
        "event": {
            "origin": "soil-moisture-sensor",
            "module": "",
            "interface": "",
            "component": "",
            "properties": {},
            "annotations": {
                "iothub-connection-device-id": "soil-moisture-sensor",
                "iothub-connection-auth-method": "{\"scope\":\"device\",\"type\":\"sas\",\"issuer\":\"iothub\",\"acceptingIpFilterRule\":null}",
                "iothub-connection-auth-generation-id": "637553997165220462",
                "iothub-enqueuedtime": 1619976150288,
                "iothub-message-source": "Telemetry",
                "x-opt-sequence-number": 1379,
                "x-opt-offset": "550576",
                "x-opt-enqueued-time": 1619976150277
            },
            "payload": "{\"soil_moisture\": 381}"
        }
    }
    ```

     æ³¨é‡Šä¸­çš„æ—¶é—´å€¼é‡‡ç”¨ [UNIX æ—¶é—´](https://wikipedia.org/wiki/Unix_time)ï¼Œè¡¨ç¤ºè‡ª 1970 å¹´ 1 æœˆ 1 æ—¥åˆå¤œä»¥æ¥çš„ç§’æ•°ã€‚

     å®Œæˆåé€€å‡ºäº‹ä»¶ç›‘è§†å™¨ã€‚

### ä»»åŠ¡ - æ§åˆ¶æ‚¨çš„ IoT è®¾å¤‡

ä½ è¿˜å¯ä»¥ä½¿ç”¨ Azure CLI è°ƒç”¨ IoT è®¾å¤‡ä¸Šçš„ç›´æ¥æ–¹æ³•ã€‚

1. åœ¨å‘½ä»¤æç¤ºç¬¦æˆ–ç»ˆç«¯ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ä»¥è°ƒç”¨ IoT è®¾å¤‡ä¸Šçš„ `relay_on` æ–¹æ³•ï¼š

    ```sh
    az iot hub invoke-device-method --device-id soil-moisture-sensor \
                                    --method-name relay_on \
                                    --method-payload '{}' \
                                    --hub-name <hub_name>
    ```

     å°† `<hub_name>` æ›¿æ¢ä¸ºæ‚¨ç”¨äº IoT ä¸­å¿ƒçš„åç§°ã€‚

     è¿™ä¼šå‘é€å¯¹`method-name`  æŒ‡å®šçš„æ–¹æ³•çš„ç›´æ¥æ–¹æ³•è¯·æ±‚ã€‚ ç›´æ¥æ–¹æ³•å¯ä»¥é‡‡ç”¨åŒ…å«è¯¥æ–¹æ³•æ•°æ®çš„æœ‰æ•ˆè´Ÿè½½ï¼Œå¹¶ä¸”å¯ä»¥åœ¨`method-payload`  å‚æ•°ä¸­å°†å…¶æŒ‡å®šä¸º JSONã€‚

     æ‚¨å°†çœ‹åˆ°ç»§ç”µå™¨æ‰“å¼€ï¼Œä»¥åŠ IoT è®¾å¤‡çš„ç›¸åº”è¾“å‡ºï¼š

    ```output
    Direct method received -  relay_on
    ```

1. é‡å¤ä¸Šè¿°æ­¥éª¤ï¼Œä½†å°† `--method-name` è®¾ç½®ä¸º `relay_off`ã€‚ æ‚¨å°†çœ‹åˆ°ç»§ç”µå™¨å…³é—­ä»¥åŠ IoT è®¾å¤‡çš„ç›¸åº”è¾“å‡ºã€‚

---

## ğŸš€ æŒ‘æˆ˜

IoT ä¸­å¿ƒçš„å…è´¹å¥—é¤æ¯å¤©å…è®¸å‘é€ 8,000 æ¡æ¶ˆæ¯ã€‚ æ‚¨ç¼–å†™çš„ä»£ç æ¯ 10 ç§’å‘é€ä¸€æ¬¡é¥æµ‹æ¶ˆæ¯ã€‚ æ¯ 10 ç§’ä¸€æ¡æ¶ˆæ¯æ¯å¤©æœ‰å¤šå°‘æ¡æ¶ˆæ¯ï¼Ÿ

è€ƒè™‘ä¸€ä¸‹åœŸå£¤æ¹¿åº¦æµ‹é‡ç»“æœåº”è¯¥å¤šä¹…å‘é€ä¸€æ¬¡ï¼Ÿ å¦‚ä½•æ›´æ”¹ä»£ç ä»¥ä¿æŒåœ¨å…è´¹å¥—é¤å†…å¹¶æ ¹æ®éœ€è¦ç»å¸¸æ£€æŸ¥ä½†åˆä¸è¿‡äºé¢‘ç¹ï¼Ÿ å¦‚æœæ‚¨æƒ³æ·»åŠ ç¬¬äºŒå°è®¾å¤‡æ€ä¹ˆåŠï¼Ÿ

## è¯¾åæµ‹éªŒ

[è¯¾åæµ‹éªŒ](https://black-meadow-040d15503.1.azurestaticapps.net/quiz/16)

## å¤ä¹ ä¸è‡ªå­¦

IoT ä¸­å¿ƒ SDK å¯¹äº Arduino å’Œ Python éƒ½æ˜¯å¼€æºçš„ã€‚ åœ¨ GitHub ä¸Šçš„ä»£ç å­˜å‚¨åº“ä¸­ï¼Œæœ‰è®¸å¤šç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ä¸åŒçš„ IoT ä¸­å¿ƒåŠŸèƒ½ã€‚

* å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯ Wio ç»ˆç«¯ï¼Œè¯·æŸ¥çœ‹ [GitHub ä¸Šçš„ Arduino ç¤ºä¾‹](https://github.com/Azure/azure-iot-pal-arduino/tree/master/pal/samples)
* å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯ Raspberry Pi æˆ–è™šæ‹Ÿè®¾å¤‡ï¼Œè¯·æŸ¥çœ‹ GitHub ä¸Šçš„ [Python ç¤ºä¾‹](https://github.com/Azure/azure-iot-sdk-python/tree/master/azure-iot-hub/samples)

##  ä»»åŠ¡

[äº†è§£äº‘æœåŠ¡](../assignment.md)
           
          
         
        
       
      
     
    
   